Introduction

PPG sensors are becoming increasingly common in wearable fitness technology, enabling real-time heart activity monitoring through measurements of blood and volume changes. These sensors work by emitting light into the skin and detecting the amount of light absorbed or reflected by blood vessels, which changes with each heartbeat as blood volume increases and decreases. When integrated with Arduino microcontrollers, PPG sensors offer a handson way to apply EE principles such as analog signal processing, noise filtering, and ADC conversion. The Arduino uses an ADC converter to sample the PPG sensor’s output voltage at set intervals, which transforms the continuous signal from the sensor into discrete digital values that can then be analyzed to calculate heart rate and other exercise-related metrics. 

For athletes and fitness enthusiasts, being able to tell the difference between aerobic and anaerobic exercise is crucial for making training more effective and reaching specific performance goals. Aerobic exercise uses oxygen as its main energy source and typically includes moderate-intensity activities that can be done for longer periods: like jogging, swimming, or cycling, which helps build cardiovascular endurance and improves how efficiently the body uses oxygen. On the other hand, anaerobic exercise relies on energy already stored in the muscles rather than oxygen, allowing for high-intensity bursts of activity like sprinting or weightlifting that build strength and power but can only last for short periods. Athletes must carefully balance both types of exercise in their training, since doing too much anaerobic work without sufficient aerobic base can result in poor recovery and higher injury risk, whereas focusing too heavily on aerobic training may limit strength and power development. Having a system that classifies exercise types in real-time allows athletes to confirm they are working in their target zones and staying at the right intensity levels during their workouts.

We aim to create an Arduino-based system that uses data from a PPG sensor to automatically determine whether a user is doing aerobic or anaerobic exercise by looking at their heart rate patterns and intensity levels. The system works by examining the heart rate patterns and intensity levels. The system works by examining the heart rate data collected from the PPG sensor and comparing it to known thresholds that separate aerobic from anaerobic activity, which allows it to give immediate feedback on what type of exercise is being performed. This helps athletes and fitness enthusiasts make sure their workouts match their specific training goals.

Methods/Implementations

As we performed a similar lab in class, we already had an idea on what the base of the code would look like. Thus, we began by obtaining the code from the oximeter sensor lab, which was what provided the basic framework for utilizing and accessing the PPG sensor and reading heart rate data. The initial code utilized the MAX86916 PPG sensor library to collect infrared and red light readings, which were then processed to detect heartbeats based on signal peaks. 

However, during the development, we ran into several problems with the AD5593R library that controls the DAC on the demoboard. Many of the required functions, such as initADAC(), setDACGain(), setDACpin(), and setDACVal(), were not included in the Rob Tillaart AD5593R library that was available on Arduino IDE. To resolve this issue, a compatibility layer was created (mention specific lines??) that implements these missing functions using the methods that the library did provide. For example, setDACGain() was recreated by calling the library’s setDACRang2x() function, and setDACVal() was implemented using the library’s writeDAC() function while adding input validation to ensure the 12-bit DAC values stayed within the valid range of 0 to 4095. 

The main exercise classification function, detect_exercise_type(), samples PPG data over appx 30 seconds at around 100 Hz (10 ms sampling period). The algorithm code is written in a way where the algorithm first removes the DC component from the raw infrared signal using a high-pass filter with an exponential moving average coefficient of 0.97, then detects heartbeats by identifying local peaks in the AC signal. These peaks must exceed a minimum threshold and be spaced at least 250 milliseconds apart to prevent false detections. As the system collects data, it stores all AC signal values and their corresponding timestamps in arrays for later analysis. After the measurement window completes, the code calculates the average BPM by multiplying the total number of detected beats by 2 (since 30 seconds is half a minute). Based on the heart average heart rate, the system classifies the exercise as anaerobic (greater or equal to 140 BPM), aerobic (90-139 BPM), or resting/light activity (less than 90 BPM), and provides contextual guidance about typical activities that fall into each category. Additionally, since these heart rates can vary from person to person, it is important to calibrate these threshold values for aerobic and anaerobic respiration. For example, an elite athlete’s heart rate during aerobic exercise might be the same as the average person’s resting heart rate so their threshold values will be than those of the average person. Thus, the device should be personalized for each user for it to provide accurate outputs.

Results/Discussion

We evaluated the system’s ability to classify exercise type by collecting PPG data from one participant, Laila, after three different activity conditions: resting, sustained walking (aerobic), and brief stair sprints (anaerobic). After each exercise, Laila immediately placed her finger on the PPG sensor for 30 seconds while the system recorded infrared PPG data, detected heartbeat peaks, and estimated BPM. 
During the resting trial, the system detected 22 heartbeats, corresponding to a heart rate of 44 BPM. This value aligns with a baseline physiological state, and the classifier correctly identified the activity as rest or very light activity. The PPG waveform for this trial was low in amplitude and highly stable, reflecting the minimal cardiovascular demand of rest.

In the aerobic trial, Laila walked in circles continuously for an extended period to elevate her heart rate in a steady, sustainable manner. The system recorded 35 beats, resulting in a heart rate of 70 BPM, which falls within typical aerobic training zones for light, sustained movement. The classifier labeled this trial as aerobic, and the recorded waveform displayed stronger pulsatile peaks and increased variability compared to the resting measurement.

Finally, during the anaerobic trial, Laila performed short, high-intensity stair sprints designed to produce an immediate spike in heart rate. The system detected 78 beats, yielding a  heart rate of 156 BPM, well above the anaerobic classification threshold. The classifier correctly identified this trial as anaerobic, and the waveform showed large-amplitude peaks and rapid beat-to-beat variability characteristic of post-sprint cardiovascular response. 
Across all three trials, the measured BPM values matched the expected physiological patterns of the corresponding activity, and the classifier produced the correct exercise label each time. The results show that the system reliably distinguishes between rest, aerobic exercise, and anaerobic exercise using only PPG-derived BPM. Because Laila served as the controlled variable throughout testing, the comparison between trials reflects consistent physiological response rather than differences between subjects. The increasing BPM across the three activities followed the expected trend: low during rest, moderately elevated during sustained walking, and sharply increased after high-intensity stair sprints. This clear separation allowed the threshold-based classifier to perform effectively despite its simplicity.

